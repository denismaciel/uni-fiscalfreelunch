//Figure 3
//Impact of multiplier varies with the level of government spending,
//assuming the taste shock induces an eight quarter liquidity trap


// government spending shock
shocks;
var eps_gov;
periods 1:1;
values (sig_gov);
end;

// consumption taste shock
shocks;
var eps_con;
periods 1:1;
values(-sig_con);
end;

// Change in government spending shock (loop parameter sig_gov)
A = zeros(11,42);
@#define x = ["-0.998","-0.996","-0.99399","-0.99199","-0.98999","-0.98799","-0.98599","-0.98398","-0.98198","-0.97998","-0.97798","-0.97598","-0.97397","-0.97197","-0.96997","-0.96797","-0.96597","-0.96396","-0.96196","-0.95996","-0.95796","-0.95596","-0.95395","-0.95195","-0.94995","-0.94795","-0.94595","-0.94394","-0.94194","-0.93994","-0.93794","-0.93594","-0.93393","-0.93193","-0.92993","-0.92793","-0.92593","-0.92392","-0.92192","-0.91992","-0.91792","-0.91592","-0.91391","-0.91191","-0.90991","-0.90791","-0.90591","-0.9039","-0.9019","-0.8999","-0.8979","-0.8959","-0.89389","-0.89189","-0.88989","-0.88789","-0.88589","-0.88388","-0.88188","-0.87988","-0.87788","-0.87588","-0.87387","-0.87187","-0.86987","-0.86787","-0.86587","-0.86386","-0.86186","-0.85986","-0.85786","-0.85586","-0.85385","-0.85185","-0.84985","-0.84785","-0.84585","-0.84384","-0.84184","-0.83984","-0.83784","-0.83584","-0.83383","-0.83183","-0.82983","-0.82783","-0.82583","-0.82382","-0.82182","-0.81982","-0.81782","-0.81582","-0.81381","-0.81181","-0.80981","-0.80781","-0.80581","-0.8038","-0.8018","-0.7998","-0.7978","-0.7958","-0.79379","-0.79179","-0.78979","-0.78779","-0.78579","-0.78378","-0.78178","-0.77978","-0.77778","-0.77578","-0.77377","-0.77177","-0.76977","-0.76777","-0.76577","-0.76376","-0.76176","-0.75976","-0.75776","-0.75576","-0.75375","-0.75175","-0.74975","-0.74775","-0.74575","-0.74374","-0.74174","-0.73974","-0.73774","-0.73574","-0.73373","-0.73173","-0.72973","-0.72773","-0.72573","-0.72372","-0.72172","-0.71972","-0.71772","-0.71572","-0.71371","-0.71171","-0.70971","-0.70771","-0.70571","-0.7037","-0.7017","-0.6997","-0.6977","-0.6957","-0.69369","-0.69169","-0.68969","-0.68769","-0.68569","-0.68368","-0.68168","-0.67968","-0.67768","-0.67568","-0.67367","-0.67167","-0.66967","-0.66767","-0.66567","-0.66366","-0.66166","-0.65966","-0.65766","-0.65566","-0.65365","-0.65165","-0.64965","-0.64765","-0.64565","-0.64364","-0.64164","-0.63964","-0.63764","-0.63564","-0.63363","-0.63163","-0.62963","-0.62763","-0.62563","-0.62362","-0.62162","-0.61962","-0.61762","-0.61562","-0.61361","-0.61161","-0.60961","-0.60761","-0.60561","-0.6036","-0.6016","-0.5996","-0.5976","-0.5956","-0.59359","-0.59159","-0.58959","-0.58759","-0.58559","-0.58358","-0.58158","-0.57958","-0.57758","-0.57558","-0.57357","-0.57157","-0.56957","-0.56757","-0.56557","-0.56356","-0.56156","-0.55956","-0.55756","-0.55556","-0.55355","-0.55155","-0.54955","-0.54755","-0.54555","-0.54354","-0.54154","-0.53954","-0.53754","-0.53554","-0.53353","-0.53153","-0.52953","-0.52753","-0.52553","-0.52352","-0.52152","-0.51952","-0.51752","-0.51552","-0.51351","-0.51151","-0.50951","-0.50751","-0.50551","-0.5035","-0.5015","-0.4995","-0.4975","-0.4955","-0.49349","-0.49149","-0.48949","-0.48749","-0.48549","-0.48348","-0.48148","-0.47948","-0.47748","-0.47548","-0.47347","-0.47147","-0.46947","-0.46747","-0.46547","-0.46346","-0.46146","-0.45946","-0.45746","-0.45546","-0.45345","-0.45145","-0.44945","-0.44745","-0.44545","-0.44344","-0.44144","-0.43944","-0.43744","-0.43544","-0.43343","-0.43143","-0.42943","-0.42743","-0.42543","-0.42342","-0.42142","-0.41942","-0.41742","-0.41542","-0.41341","-0.41141","-0.40941","-0.40741","-0.40541","-0.4034","-0.4014","-0.3994","-0.3974","-0.3954","-0.39339","-0.39139","-0.38939","-0.38739","-0.38539","-0.38338","-0.38138","-0.37938","-0.37738","-0.37538","-0.37337","-0.37137","-0.36937","-0.36737","-0.36537","-0.36336","-0.36136","-0.35936","-0.35736","-0.35536","-0.35335","-0.35135","-0.34935","-0.34735","-0.34535","-0.34334","-0.34134","-0.33934","-0.33734","-0.33534","-0.33333","-0.33133","-0.32933","-0.32733","-0.32533","-0.32332","-0.32132","-0.31932","-0.31732","-0.31532","-0.31331","-0.31131","-0.30931","-0.30731","-0.30531","-0.3033","-0.3013","-0.2993","-0.2973","-0.2953","-0.29329","-0.29129","-0.28929","-0.28729","-0.28529","-0.28328","-0.28128","-0.27928","-0.27728","-0.27528","-0.27327","-0.27127","-0.26927","-0.26727","-0.26527","-0.26326","-0.26126","-0.25926","-0.25726","-0.25526","-0.25325","-0.25125","-0.24925","-0.24725","-0.24525","-0.24324","-0.24124","-0.23924","-0.23724","-0.23524","-0.23323","-0.23123","-0.22923","-0.22723","-0.22523","-0.22322","-0.22122","-0.21922","-0.21722","-0.21522","-0.21321","-0.21121","-0.20921","-0.20721","-0.20521","-0.2032","-0.2012","-0.1992","-0.1972","-0.1952","-0.19319","-0.19119","-0.18919","-0.18719","-0.18519","-0.18318","-0.18118","-0.17918","-0.17718","-0.17518","-0.17317","-0.17117","-0.16917","-0.16717","-0.16517","-0.16316","-0.16116","-0.15916","-0.15716","-0.15516","-0.15315","-0.15115","-0.14915","-0.14715","-0.14515","-0.14314","-0.14114","-0.13914","-0.13714","-0.13514","-0.13313","-0.13113","-0.12913","-0.12713","-0.12513","-0.12312","-0.12112","-0.11912","-0.11712","-0.11512","-0.11311","-0.11111","-0.10911","-0.10711","-0.10511","-0.1031","-0.1011","-0.099099","-0.097097","-0.095095","-0.093093","-0.091091","-0.089089","-0.087087","-0.085085","-0.083083","-0.081081","-0.079079","-0.077077","-0.075075","-0.073073","-0.071071","-0.069069","-0.067067","-0.065065","-0.063063","-0.061061","-0.059059","-0.057057","-0.055055","-0.053053","-0.051051","-0.049049","-0.047047","-0.045045","-0.043043","-0.041041","-0.039039","-0.037037","-0.035035","-0.033033","-0.031031","-0.029029","-0.027027","-0.025025","-0.023023","-0.021021","-0.019019","-0.017017","-0.015015","-0.013013","-0.011011","-0.009009","-0.007007","-0.005005","-0.003003","-0.001001","0.001001","0.003003","0.005005","0.007007","0.009009","0.011011","0.013013","0.015015","0.017017","0.019019","0.021021","0.023023","0.025025","0.027027","0.029029","0.031031","0.033033","0.035035","0.037037","0.039039","0.041041","0.043043","0.045045","0.047047","0.049049","0.051051","0.053053","0.055055","0.057057","0.059059","0.061061","0.063063","0.065065","0.067067","0.069069","0.071071","0.073073","0.075075","0.077077","0.079079","0.081081","0.083083","0.085085","0.087087","0.089089","0.091091","0.093093","0.095095","0.097097","0.099099","0.1011","0.1031","0.10511","0.10711","0.10911","0.11111","0.11311","0.11512","0.11712","0.11912","0.12112","0.12312","0.12513","0.12713","0.12913","0.13113","0.13313","0.13514","0.13714","0.13914","0.14114","0.14314","0.14515","0.14715","0.14915","0.15115","0.15315","0.15516","0.15716","0.15916","0.16116","0.16316","0.16517","0.16717","0.16917","0.17117","0.17317","0.17518","0.17718","0.17918","0.18118","0.18318","0.18519","0.18719","0.18919","0.19119","0.19319","0.1952","0.1972","0.1992","0.2012","0.2032","0.20521","0.20721","0.20921","0.21121","0.21321","0.21522","0.21722","0.21922","0.22122","0.22322","0.22523","0.22723","0.22923","0.23123","0.23323","0.23524","0.23724","0.23924","0.24124","0.24324","0.24525","0.24725","0.24925","0.25125","0.25325","0.25526","0.25726","0.25926","0.26126","0.26326","0.26527","0.26727","0.26927","0.27127","0.27327","0.27528","0.27728","0.27928","0.28128","0.28328","0.28529","0.28729","0.28929","0.29129","0.29329","0.2953","0.2973","0.2993","0.3013","0.3033","0.30531","0.30731","0.30931","0.31131","0.31331","0.31532","0.31732","0.31932","0.32132","0.32332","0.32533","0.32733","0.32933","0.33133","0.33333","0.33534","0.33734","0.33934","0.34134","0.34334","0.34535","0.34735","0.34935","0.35135","0.35335","0.35536","0.35736","0.35936","0.36136","0.36336","0.36537","0.36737","0.36937","0.37137","0.37337","0.37538","0.37738","0.37938","0.38138","0.38338","0.38539","0.38739","0.38939","0.39139","0.39339","0.3954","0.3974","0.3994","0.4014","0.4034","0.40541","0.40741","0.40941","0.41141","0.41341","0.41542","0.41742","0.41942","0.42142","0.42342","0.42543","0.42743","0.42943","0.43143","0.43343","0.43544","0.43744","0.43944","0.44144","0.44344","0.44545","0.44745","0.44945","0.45145","0.45345","0.45546","0.45746","0.45946","0.46146","0.46346","0.46547","0.46747","0.46947","0.47147","0.47347","0.47548","0.47748","0.47948","0.48148","0.48348","0.48549","0.48749","0.48949","0.49149","0.49349","0.4955","0.4975","0.4995","0.5015","0.5035","0.50551","0.50751","0.50951","0.51151","0.51351","0.51552","0.51752","0.51952","0.52152","0.52352","0.52553","0.52753","0.52953","0.53153","0.53353","0.53554","0.53754","0.53954","0.54154","0.54354","0.54555","0.54755","0.54955","0.55155","0.55355","0.55556","0.55756","0.55956","0.56156","0.56356","0.56557","0.56757","0.56957","0.57157","0.57357","0.57558","0.57758","0.57958","0.58158","0.58358","0.58559","0.58759","0.58959","0.59159","0.59359","0.5956","0.5976","0.5996","0.6016","0.6036","0.60561","0.60761","0.60961","0.61161","0.61361","0.61562","0.61762","0.61962","0.62162","0.62362","0.62563","0.62763","0.62963","0.63163","0.63363","0.63564","0.63764","0.63964","0.64164","0.64364","0.64565","0.64765","0.64965","0.65165","0.65365","0.65566","0.65766","0.65966","0.66166","0.66366","0.66567","0.66767","0.66967","0.67167","0.67367","0.67568","0.67768","0.67968","0.68168","0.68368","0.68569","0.68769","0.68969","0.69169","0.69369","0.6957","0.6977","0.6997","0.7017","0.7037","0.70571","0.70771","0.70971","0.71171","0.71371","0.71572","0.71772","0.71972","0.72172","0.72372","0.72573","0.72773","0.72973","0.73173","0.73373","0.73574","0.73774","0.73974","0.74174","0.74374","0.74575","0.74775","0.74975","0.75175","0.75375","0.75576","0.75776","0.75976","0.76176","0.76376","0.76577","0.76777","0.76977","0.77177","0.77377","0.77578","0.77778","0.77978","0.78178","0.78378","0.78579","0.78779","0.78979","0.79179","0.79379","0.7958","0.7978","0.7998","0.8018","0.8038","0.80581","0.80781","0.80981","0.81181","0.81381","0.81582","0.81782","0.81982","0.82182","0.82382","0.82583","0.82783","0.82983","0.83183","0.83383","0.83584","0.83784","0.83984","0.84184","0.84384","0.84585","0.84785","0.84985","0.85185","0.85385","0.85586","0.85786","0.85986","0.86186","0.86386","0.86587","0.86787","0.86987","0.87187","0.87387","0.87588","0.87788","0.87988","0.88188","0.88388","0.88589","0.88789","0.88989","0.89189","0.89389","0.8959","0.8979","0.8999","0.9019","0.9039","0.90591","0.90791","0.90991","0.91191","0.91391","0.91592","0.91792","0.91992","0.92192","0.92392","0.92593","0.92793","0.92993","0.93193","0.93393","0.93594","0.93794","0.93994","0.94194","0.94394","0.94595","0.94795","0.94995","0.95195","0.95395","0.95596","0.95796","0.95996","0.96196","0.96396","0.96597","0.96797","0.96997","0.97197","0.97397","0.97598","0.97798","0.97998","0.98198","0.98398","0.98599","0.98799","0.98999","0.99199","0.99399","0.996","0.998","1"]

@#for sig_gov_val in x
	sig_gov = @{sig_gov_val};

	shocks;
	var eps_gov;
	periods 1:1;
	values (sig_gov);
	end;

	simul(periods=40);
	A = cat(3, A, oo_.endo_simul);
@#endfor

// Remove the first layer because it consists only of zeros
A = A(:,:,2:end);

liqduration = zeros(size(A,3),1);
for i = 1:size(A,3)
	x = sum(A(3, 1:end, i) == -ibar);
	liqduration(i) = x;
end

x = [-0.998,-0.996,-0.99399,-0.99199,-0.98999,-0.98799,-0.98599,-0.98398,-0.98198,-0.97998,-0.97798,-0.97598,-0.97397,-0.97197,-0.96997,-0.96797,-0.96597,-0.96396,-0.96196,-0.95996,-0.95796,-0.95596,-0.95395,-0.95195,-0.94995,-0.94795,-0.94595,-0.94394,-0.94194,-0.93994,-0.93794,-0.93594,-0.93393,-0.93193,-0.92993,-0.92793,-0.92593,-0.92392,-0.92192,-0.91992,-0.91792,-0.91592,-0.91391,-0.91191,-0.90991,-0.90791,-0.90591,-0.9039,-0.9019,-0.8999,-0.8979,-0.8959,-0.89389,-0.89189,-0.88989,-0.88789,-0.88589,-0.88388,-0.88188,-0.87988,-0.87788,-0.87588,-0.87387,-0.87187,-0.86987,-0.86787,-0.86587,-0.86386,-0.86186,-0.85986,-0.85786,-0.85586,-0.85385,-0.85185,-0.84985,-0.84785,-0.84585,-0.84384,-0.84184,-0.83984,-0.83784,-0.83584,-0.83383,-0.83183,-0.82983,-0.82783,-0.82583,-0.82382,-0.82182,-0.81982,-0.81782,-0.81582,-0.81381,-0.81181,-0.80981,-0.80781,-0.80581,-0.8038,-0.8018,-0.7998,-0.7978,-0.7958,-0.79379,-0.79179,-0.78979,-0.78779,-0.78579,-0.78378,-0.78178,-0.77978,-0.77778,-0.77578,-0.77377,-0.77177,-0.76977,-0.76777,-0.76577,-0.76376,-0.76176,-0.75976,-0.75776,-0.75576,-0.75375,-0.75175,-0.74975,-0.74775,-0.74575,-0.74374,-0.74174,-0.73974,-0.73774,-0.73574,-0.73373,-0.73173,-0.72973,-0.72773,-0.72573,-0.72372,-0.72172,-0.71972,-0.71772,-0.71572,-0.71371,-0.71171,-0.70971,-0.70771,-0.70571,-0.7037,-0.7017,-0.6997,-0.6977,-0.6957,-0.69369,-0.69169,-0.68969,-0.68769,-0.68569,-0.68368,-0.68168,-0.67968,-0.67768,-0.67568,-0.67367,-0.67167,-0.66967,-0.66767,-0.66567,-0.66366,-0.66166,-0.65966,-0.65766,-0.65566,-0.65365,-0.65165,-0.64965,-0.64765,-0.64565,-0.64364,-0.64164,-0.63964,-0.63764,-0.63564,-0.63363,-0.63163,-0.62963,-0.62763,-0.62563,-0.62362,-0.62162,-0.61962,-0.61762,-0.61562,-0.61361,-0.61161,-0.60961,-0.60761,-0.60561,-0.6036,-0.6016,-0.5996,-0.5976,-0.5956,-0.59359,-0.59159,-0.58959,-0.58759,-0.58559,-0.58358,-0.58158,-0.57958,-0.57758,-0.57558,-0.57357,-0.57157,-0.56957,-0.56757,-0.56557,-0.56356,-0.56156,-0.55956,-0.55756,-0.55556,-0.55355,-0.55155,-0.54955,-0.54755,-0.54555,-0.54354,-0.54154,-0.53954,-0.53754,-0.53554,-0.53353,-0.53153,-0.52953,-0.52753,-0.52553,-0.52352,-0.52152,-0.51952,-0.51752,-0.51552,-0.51351,-0.51151,-0.50951,-0.50751,-0.50551,-0.5035,-0.5015,-0.4995,-0.4975,-0.4955,-0.49349,-0.49149,-0.48949,-0.48749,-0.48549,-0.48348,-0.48148,-0.47948,-0.47748,-0.47548,-0.47347,-0.47147,-0.46947,-0.46747,-0.46547,-0.46346,-0.46146,-0.45946,-0.45746,-0.45546,-0.45345,-0.45145,-0.44945,-0.44745,-0.44545,-0.44344,-0.44144,-0.43944,-0.43744,-0.43544,-0.43343,-0.43143,-0.42943,-0.42743,-0.42543,-0.42342,-0.42142,-0.41942,-0.41742,-0.41542,-0.41341,-0.41141,-0.40941,-0.40741,-0.40541,-0.4034,-0.4014,-0.3994,-0.3974,-0.3954,-0.39339,-0.39139,-0.38939,-0.38739,-0.38539,-0.38338,-0.38138,-0.37938,-0.37738,-0.37538,-0.37337,-0.37137,-0.36937,-0.36737,-0.36537,-0.36336,-0.36136,-0.35936,-0.35736,-0.35536,-0.35335,-0.35135,-0.34935,-0.34735,-0.34535,-0.34334,-0.34134,-0.33934,-0.33734,-0.33534,-0.33333,-0.33133,-0.32933,-0.32733,-0.32533,-0.32332,-0.32132,-0.31932,-0.31732,-0.31532,-0.31331,-0.31131,-0.30931,-0.30731,-0.30531,-0.3033,-0.3013,-0.2993,-0.2973,-0.2953,-0.29329,-0.29129,-0.28929,-0.28729,-0.28529,-0.28328,-0.28128,-0.27928,-0.27728,-0.27528,-0.27327,-0.27127,-0.26927,-0.26727,-0.26527,-0.26326,-0.26126,-0.25926,-0.25726,-0.25526,-0.25325,-0.25125,-0.24925,-0.24725,-0.24525,-0.24324,-0.24124,-0.23924,-0.23724,-0.23524,-0.23323,-0.23123,-0.22923,-0.22723,-0.22523,-0.22322,-0.22122,-0.21922,-0.21722,-0.21522,-0.21321,-0.21121,-0.20921,-0.20721,-0.20521,-0.2032,-0.2012,-0.1992,-0.1972,-0.1952,-0.19319,-0.19119,-0.18919,-0.18719,-0.18519,-0.18318,-0.18118,-0.17918,-0.17718,-0.17518,-0.17317,-0.17117,-0.16917,-0.16717,-0.16517,-0.16316,-0.16116,-0.15916,-0.15716,-0.15516,-0.15315,-0.15115,-0.14915,-0.14715,-0.14515,-0.14314,-0.14114,-0.13914,-0.13714,-0.13514,-0.13313,-0.13113,-0.12913,-0.12713,-0.12513,-0.12312,-0.12112,-0.11912,-0.11712,-0.11512,-0.11311,-0.11111,-0.10911,-0.10711,-0.10511,-0.1031,-0.1011,-0.099099,-0.097097,-0.095095,-0.093093,-0.091091,-0.089089,-0.087087,-0.085085,-0.083083,-0.081081,-0.079079,-0.077077,-0.075075,-0.073073,-0.071071,-0.069069,-0.067067,-0.065065,-0.063063,-0.061061,-0.059059,-0.057057,-0.055055,-0.053053,-0.051051,-0.049049,-0.047047,-0.045045,-0.043043,-0.041041,-0.039039,-0.037037,-0.035035,-0.033033,-0.031031,-0.029029,-0.027027,-0.025025,-0.023023,-0.021021,-0.019019,-0.017017,-0.015015,-0.013013,-0.011011,-0.009009,-0.007007,-0.005005,-0.003003,-0.001001,0.001001,0.003003,0.005005,0.007007,0.009009,0.011011,0.013013,0.015015,0.017017,0.019019,0.021021,0.023023,0.025025,0.027027,0.029029,0.031031,0.033033,0.035035,0.037037,0.039039,0.041041,0.043043,0.045045,0.047047,0.049049,0.051051,0.053053,0.055055,0.057057,0.059059,0.061061,0.063063,0.065065,0.067067,0.069069,0.071071,0.073073,0.075075,0.077077,0.079079,0.081081,0.083083,0.085085,0.087087,0.089089,0.091091,0.093093,0.095095,0.097097,0.099099,0.1011,0.1031,0.10511,0.10711,0.10911,0.11111,0.11311,0.11512,0.11712,0.11912,0.12112,0.12312,0.12513,0.12713,0.12913,0.13113,0.13313,0.13514,0.13714,0.13914,0.14114,0.14314,0.14515,0.14715,0.14915,0.15115,0.15315,0.15516,0.15716,0.15916,0.16116,0.16316,0.16517,0.16717,0.16917,0.17117,0.17317,0.17518,0.17718,0.17918,0.18118,0.18318,0.18519,0.18719,0.18919,0.19119,0.19319,0.1952,0.1972,0.1992,0.2012,0.2032,0.20521,0.20721,0.20921,0.21121,0.21321,0.21522,0.21722,0.21922,0.22122,0.22322,0.22523,0.22723,0.22923,0.23123,0.23323,0.23524,0.23724,0.23924,0.24124,0.24324,0.24525,0.24725,0.24925,0.25125,0.25325,0.25526,0.25726,0.25926,0.26126,0.26326,0.26527,0.26727,0.26927,0.27127,0.27327,0.27528,0.27728,0.27928,0.28128,0.28328,0.28529,0.28729,0.28929,0.29129,0.29329,0.2953,0.2973,0.2993,0.3013,0.3033,0.30531,0.30731,0.30931,0.31131,0.31331,0.31532,0.31732,0.31932,0.32132,0.32332,0.32533,0.32733,0.32933,0.33133,0.33333,0.33534,0.33734,0.33934,0.34134,0.34334,0.34535,0.34735,0.34935,0.35135,0.35335,0.35536,0.35736,0.35936,0.36136,0.36336,0.36537,0.36737,0.36937,0.37137,0.37337,0.37538,0.37738,0.37938,0.38138,0.38338,0.38539,0.38739,0.38939,0.39139,0.39339,0.3954,0.3974,0.3994,0.4014,0.4034,0.40541,0.40741,0.40941,0.41141,0.41341,0.41542,0.41742,0.41942,0.42142,0.42342,0.42543,0.42743,0.42943,0.43143,0.43343,0.43544,0.43744,0.43944,0.44144,0.44344,0.44545,0.44745,0.44945,0.45145,0.45345,0.45546,0.45746,0.45946,0.46146,0.46346,0.46547,0.46747,0.46947,0.47147,0.47347,0.47548,0.47748,0.47948,0.48148,0.48348,0.48549,0.48749,0.48949,0.49149,0.49349,0.4955,0.4975,0.4995,0.5015,0.5035,0.50551,0.50751,0.50951,0.51151,0.51351,0.51552,0.51752,0.51952,0.52152,0.52352,0.52553,0.52753,0.52953,0.53153,0.53353,0.53554,0.53754,0.53954,0.54154,0.54354,0.54555,0.54755,0.54955,0.55155,0.55355,0.55556,0.55756,0.55956,0.56156,0.56356,0.56557,0.56757,0.56957,0.57157,0.57357,0.57558,0.57758,0.57958,0.58158,0.58358,0.58559,0.58759,0.58959,0.59159,0.59359,0.5956,0.5976,0.5996,0.6016,0.6036,0.60561,0.60761,0.60961,0.61161,0.61361,0.61562,0.61762,0.61962,0.62162,0.62362,0.62563,0.62763,0.62963,0.63163,0.63363,0.63564,0.63764,0.63964,0.64164,0.64364,0.64565,0.64765,0.64965,0.65165,0.65365,0.65566,0.65766,0.65966,0.66166,0.66366,0.66567,0.66767,0.66967,0.67167,0.67367,0.67568,0.67768,0.67968,0.68168,0.68368,0.68569,0.68769,0.68969,0.69169,0.69369,0.6957,0.6977,0.6997,0.7017,0.7037,0.70571,0.70771,0.70971,0.71171,0.71371,0.71572,0.71772,0.71972,0.72172,0.72372,0.72573,0.72773,0.72973,0.73173,0.73373,0.73574,0.73774,0.73974,0.74174,0.74374,0.74575,0.74775,0.74975,0.75175,0.75375,0.75576,0.75776,0.75976,0.76176,0.76376,0.76577,0.76777,0.76977,0.77177,0.77377,0.77578,0.77778,0.77978,0.78178,0.78378,0.78579,0.78779,0.78979,0.79179,0.79379,0.7958,0.7978,0.7998,0.8018,0.8038,0.80581,0.80781,0.80981,0.81181,0.81381,0.81582,0.81782,0.81982,0.82182,0.82382,0.82583,0.82783,0.82983,0.83183,0.83383,0.83584,0.83784,0.83984,0.84184,0.84384,0.84585,0.84785,0.84985,0.85185,0.85385,0.85586,0.85786,0.85986,0.86186,0.86386,0.86587,0.86787,0.86987,0.87187,0.87387,0.87588,0.87788,0.87988,0.88188,0.88388,0.88589,0.88789,0.88989,0.89189,0.89389,0.8959,0.8979,0.8999,0.9019,0.9039,0.90591,0.90791,0.90991,0.91191,0.91391,0.91592,0.91792,0.91992,0.92192,0.92392,0.92593,0.92793,0.92993,0.93193,0.93393,0.93594,0.93794,0.93994,0.94194,0.94394,0.94595,0.94795,0.94995,0.95195,0.95395,0.95596,0.95796,0.95996,0.96196,0.96396,0.96597,0.96797,0.96997,0.97197,0.97397,0.97598,0.97798,0.97998,0.98198,0.98398,0.98599,0.98799,0.98999,0.99199,0.99399,0.996,0.998,1]

//get the amazing plot of the Stair...
plot(x, liqduration) 
xlabel('Change in Govt Spend (Share of GDP)')
ylabel('Liquidity trap duration')



//Multiplier for every value x (shocks)

//Exctract the values for y1 and g1 for each simulation
y = zeros(1, size(A,3));
g = zeros(1, size(A,3));

for i = 1:size(A,3)
z = A(10,2,i);
y(i) = z;

z = A(8,2,i);
g(i) = z;
end;

// Calculate the multiplier
mul = zeros((length(y)-1),1);

for i = 1:(length(y)-1)
mul(i) = ((y(i+1) - y(i))/ (g(i+1) - g(i))) * 1/shrgy;	
end
		
//Combine liquidity trap duration and multiplier into a single vector
liqmul = [mul,liqduration(1:(length(liqduration)-1))]

toincl = zeros((length(liqmul)-1),1);
for i = 1:(length(liqmul)-1)
	toincl(i) = liqmul(i,2) == liqmul(i+1,2);
end;

liqmul = [liqmul(1:(length(liqmul)-1),:) toincl];

droprow = find(toincl == 0);

// Drop rows in which y1 and y0 are in different liquidity traps
liqmul(droprow,:) = []
					
//Calculate Average Multiplier starting from 
u = (length(liqmul)-1)
avgmulx = zeros(u,1);
for i = round(u/2 + 2):length(liqmul);
	z = ((y(i) - y(round(u/2 + 1)))/(g(i) - g(round(u/2 + 1)))) * 1/shrgy;
	avgmulx(i) = z;
end
avgmulx
avgmulx(avgmulx == 0) = NaN
	
//
// avgmul = zeros((length(liqmul)-1),1);
// for i = 2:length(liqmul);
// 	z = (y(i) - y(1))/(g(i) - g(1));
// 	avgmul(i) = z;
// end
// avgmul


figure;
subplot(1,1,1)
plot((1/shrgy)*x(1:length(avgmulx)), avgmulx, 'g --'); hold on;
plot((1/shrgy)*x(1:length(avgmulx)), liqmul(:,1));
xlabel('% Change in Govt Spend (Share of GDP)')
ylabel('Government Spending Multiplier')